from flask import Flask, request, jsonify

app = Flask(__name__)

# 1. 【数据源】请将您的 ASCII 艺术作品粘贴到这里
# 键 (Key) 应该与您在 Dify 中调用的关键词保持一致 (例如：天气状态，新闻分类)
ASCII_GALLERY = {
    "Monkey_museum": """
....................................
....................................
........../\........................
...______/__\_______................
...||-------------||................
...||             ||................
...||    \|||/    ||................
...||   [ @-@ ]   ||................
...||    ( ' )    ||.......       ..
...||    _(O)_    ||.......|EXIT |..
...||   / >=< \   ||.......|==>> |..
...||__/_|_:_|_\__||................
...-----------------................
....................................
....................................
""",
    "cat": """
   |\---/|
   | ,_, |
    \_`_/-..----.
 ___/ `   ' ,""+ \  sk
(__...'   __\    |`.___.';
  (_,...'(_,.`__)/'.....+
""",

   "dolphin": """
              ,-.
             /  (  '
     *  _.--'!   '--._
      ,'              ''.
'    |!                   \
   _.'  O      ___       ! \
  (_.-^, __..-'  ''''--.   )
      /,'        '    _.' /
   '         *    .-''    |
                 (..--^.  ' 
                       | /
                       '
""",

   "fractal": """
      __/\__ 
      \    /   
__/\__/    \__/\__
\                /
/_              _\
  \            /
__/            \__ 
\                /
/_  __      __  _\
  \/  \    /  \/
      /_  _\
        \/
""",



   "cube": """
     +___________+
    /:\         ,:\
   / : \       , : \
  /  :  \     ,  :  \
 /   :   +-----------+
+....:../:...+   :  /|
|\   +./.:...`...+ / |
| \ ,`/  :   :` ,`/  |
|  \ /`. :   : ` /`  |
| , +-----------+  ` |
|,  |   `+...:,.|...`+
+...|...,'...+  |   /
 \  |  ,     `  |  /
  \ | ,       ` | /
   \|,         `|/   
    +___________+
""",


   "branch_for_choice": """
     .----------.         .----------.     
\   (  ||    ||  )  / \   (   ||    || )     /
 \   ~-||====||-~  /   \   ~--||====||-~    /
  \    ||    ||   /     \     ||    ||    /
  |    ||====||  /      |     ||====||   / 
  |__  ||    ||  |      |___  ||    ||  | 
  | |\ ||====||__|      |  |\ ||====||__|     
  | | \      /|  |      |  | \       /| |     
  | |  \    / |  |      |  |   \    / | |    
  | |   \__|  |  |      |  |     \__| | |
  | |   |__|  |  |      |  |     |__| | |
  | |   /  |  |  |      |  |     /  | | |
  | |  /    \ |  |      |  |   /    \ | |
  | | /      \|  |      |  | /       \| |  
  |_|/        |__|      |__|/         \_|
  |              |      |               |
  |              |      |               |
  /              \      /                \   
 /                \    /                   \  
/                  \ /                       \
""",

   "maze": """
___________________________________  
| _____ |   | ___ | ___ ___ | |   | |
| |   | |_| |__ | |_| __|____ | | | |
| | | |_________|__ |______ |___|_| |
| |_|   | _______ |______ |   | ____|
| ___ | |____ | |______ | |_| |____ |
|___|_|____ | |   ___ | |________ | |
|   ________| | |__ | |______ | | | |
| | | ________| | __|____ | | | __| |
|_| |__ |   | __|__ | ____| | |_| __|
|   ____| | |____ | |__ |   |__ |__ |
| |_______|_______|___|___|___|_____|
""",

   "book": """
   ,   ,
  /////|
 ///// |
|~~~|  |
|===|  |
|   |  |
|   |  |
|   | /
|===|/
'---'
""",

   "ballon_piggy": """
     .'''.
    '     '
    '.   .'
      '.'
       '
       '
       '
     /")\
    / /\ \
   / ()""()       
   |=( . .)
   |  '(o)|
   /______|
   |      |
 _ / ____ \ _
( ) /    \ ( )
|_|/      \|_|
""",

   "apple_computer": """
   _____________________
  /                 `   \
  |  .-----------.  |   |-----.
  |  |           |  |   |-=---|
  |  | Apple //c |  |   |-----|
  |  |           |  |   |-----|
  |  |           |  |   |-----|
  |  `-----------'  |   |-----'/\
   \________________/___'     /  \
      /                      / / /
     / //               //  / / /
    /                      / / /
   / _/_/_/_/_/_/_/_/_/_/ /   /
  / _/_/_/_/_/_/_/_/_/_/ /   /
 / _/_/_/_______/_/_/_/ / __/
/______________________/ /    
\______________________\/
""",

   "guitar_music": """
                          ,     
                      ,   |     
   _,,._              |  0'     
 ,'     `.__,--.     0'         
/   .--.        |           ,,, 
| [=========|==|==|=|==|=|==___]
\   "--"  __    |           ''' 
 `._   _,'  `--'                
    ""'     ,   ,0     ,        
           |)  |)   ,'|        
  ____     0'   '   | 0'        
  |  |             0'           
 0' 0'
""",

   "aliens": """
       .-""""-.        .-""""-.
      /        \      /        \
     /_        _\    /_        _\
    // \      / \\  // \      / \\
    |\__\    /__/|  |\__\    /__/|
     \    ||    /    \    ||    /
      \        /      \        /
       \  __  /        \  __  / 
        '.__.'          '.__.'
         |  |            |  |
         |  |            |  |
""",

   "quiet_moon_night": """
      _.-'''-._
     .'   .-'``|'.
    /    /    -*- \
   ;   <{      |   ;
   |    _\ |       | 
   ;   _\ -*- |    ;
    \   \  | -*-  /
     '._ '.__ |_.'
        '-----'
""",

   "moon": """
         ___---___                    
      .--         --.      
    ./   ()      .-. \.
   /   o    .   (   )  \
  / .            '-'    \         
 | ()    .  O         .  |      
|                         |      
|    o           ()       |
|       .--.          O   |            
 | .   |    |            |
  \    `.__.'    o   .  /    
   \                   /                   
    `\  o    ()      /'         
      `--___   ___--'
            ---
""",

   "earth": """
             _____
          .-'.  ':'-.
        .''::: .:    '.
       /   :::::'      \
      ;.    ':' `       ;
      |       '..       |
      ; '      ::::.    ;
       \       '::::   /
        '.      :::  .'
          '-.___'_.-'
""",

   "starry_large": """
   *   '*
           *
                *
                       *
               *
                     *

         .                      .
         .                      ;
         :                  - --+- -
         !           .          !
         |        .             .
         |_         +
      ,  | `.
--- --+-<#>-+- ---  --  -
      `._|_,'
         T
         |
         !
         :         . : 
         .       *
""",

   "beach": """
          |
        \ _ /
      -= (_) =-
        /   \         _\/_
          |           //o\  _\/_
   _____ _ __ __ ____ _ | __/o\\ _
 =-=-_-__=_-= _=_=-=_,-'|"'""-|-,_
  =- _=-=- -_=-=_,-"          |
    =- =- -=.--"
""",


   "cloud": """
          .-~~~-.
  .- ~ ~-(       )_ _
 /                    ~ -.
|                          ',
 \                         .'
   ~- ._ ,. ,.,.,., ,.. -~
           '       '
""",

   "rainbow": """
     _.-------._ 
   ,' _-------_ `.
  / ,'.-'----'.`. \
 | / / ,'---'. \ \ |
| | | | ,`-`. | | | |
| | | | |   | | | | |
""",

   "rain": """
                    *

             *  _|_
             .-' * '-. *
            /       * \
         *  ^^^^^|^^^^^
             .~. |  .~.
            / ^ \| / ^ \
           (|   |J/|   |)
           '\   /`"\   /`
 -- '' -'-'  ^`^    ^`^  -- '' -'-'
""",

   "mountain": """
          /\
         /**\
        /****\   /\
       /      \ /**\
      /  /\    /    \      
     /  /  \  /      \      
    /  /    \/ /\     \   
   /  /      \/  \/\   \ 
__/__/_______/___/__\___\_____
""",


    "default": "==> (未找到艺术作品) <==\n"
}

@app.route('/get_art', methods=['GET'])
def get_art():
    # 2. 从请求参数中获取关键词 (key)
    # 示例URL: http://yourdomain.com/get_art?key=cloudy
    keyword = request.args.get('key', 'default').lower() 
    
    # 3. 查找对应的艺术作品，如果找不到则返回默认
    art = ASCII_GALLERY.get(keyword, ASCII_GALLERY['default'])
    
    # 4. 返回 JSON 格式的 ASCII 艺术字符串
    # Dify 的 HTTP 节点将接收到 {"ascii_art": "..."}
    return jsonify({"ascii_art": art})

if __name__ == '__main__':
    # 这是一个本地测试运行，部署时需要不同的启动方式
    app.run(debug=True)